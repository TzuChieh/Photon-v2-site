\doxysection{PLat\+Long\+Env\+Sphere.\+h}
\hypertarget{_p_lat_long_env_sphere_8h_source}{}\label{_p_lat_long_env_sphere_8h_source}\index{Source/Core/Intersection/PLatLongEnvSphere.h@{Source/Core/Intersection/PLatLongEnvSphere.h}}
\mbox{\hyperlink{_p_lat_long_env_sphere_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_p_basic_sphere_8h}{Core/Intersection/PBasicSphere.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_vector2_8h}{Math/TVector2.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_vector3_8h}{Math/TVector3.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_a_a_b_b3_d_8h}{Math/Geometry/TAABB3D.h}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_static_rigid_transform_8h}{Math/Transform/StaticRigidTransform.h}}"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <array>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceph}{ph}}}
\DoxyCodeLine{00012\ \{}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere}{PLatLongEnvSphere}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1_p_basic_sphere}{PBasicSphere}}}
\DoxyCodeLine{00021\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ TODO:\ currently\ not\ fully\ time\ aware}}
\DoxyCodeLine{00023\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a44d9e42201895b929eceb63cf7a8114a}{PLatLongEnvSphere}}(real\ radius);}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a44d9e42201895b929eceb63cf7a8114a}{PLatLongEnvSphere}}(}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ real\ radius,\ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_static_rigid_transform}{math::StaticRigidTransform}}*\ localToWorld,}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_static_rigid_transform}{math::StaticRigidTransform}}*\ worldToLocal);}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a021ee0e189084d1047de6766bd22efe9}{isIntersecting}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_ray}{Ray}}\&\ ray,\ \mbox{\hyperlink{classph_1_1_hit_probe}{HitProbe}}\&\ probe)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a1413932615d2fb24f9ae0bc55736e29a}{isOccluding}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_ray}{Ray}}\&\ ray)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a19903549b743c79401f6aeb8a690333a}{calcHitDetail}}(}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_ray}{Ray}}\&\ ray,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_hit_probe}{HitProbe}}\&\ \ probe,}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_hit_detail}{HitDetail}}*\ out\_detail)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a8200d876050a6fc1f08e86b0a2110a87}{calcPosPdf}}(\mbox{\hyperlink{classph_1_1_primitive_pos_pdf_query}{PrimitivePosPdfQuery}}\&\ query)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_ab5b0f9014006aa9d15e6312c6ec46939}{genPosSample}}(}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_primitive_pos_sample_query}{PrimitivePosSampleQuery}}\&\ query,}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_sample_flow}{SampleFlow}}\&\ sampleFlow,}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_hit_probe}{HitProbe}}\&\ probe)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a62efab606c54547ca10d717acee6b8b1}{mayOverlapVolume}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_a_a_b_b3_d}{math::AABB3D}}\&\ volume)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_a_a_b_b3_d}{math::AABB3D}}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_ab365271a75cb844ac3bb3a1670812737}{calcAABB}}()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00048\ \ \ \ \ real\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a82ef3186774036a140db3979d63d76aa}{calcExtendedArea}}()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordtype}{void}\ genPosSampleWithObservationPos(}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector2}{math::Vector2R}}\&\ latLong01,}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ real\ latLong01Pdf,}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_primitive_pos_sample_query}{PrimitivePosSampleQuery}}\&\ query,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_hit_probe}{HitProbe}}\&\ probe)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{void}\ genPosSampleWithoutObservationPos(}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector2}{math::Vector2R}}\&\ latLong01,}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ real\ latLong01Pdf,}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_primitive_pos_sample_query}{PrimitivePosSampleQuery}}\&\ query,}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_sample_flow}{SampleFlow}}\&\ sampleFlow,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_hit_probe}{HitProbe}}\&\ probe)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordtype}{void}\ calcPosPdfWithObservationPos(}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector2}{math::Vector2R}}\&\ latLong01,}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ real\ latLong01Pdf,}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_primitive_pos_pdf_query}{PrimitivePosPdfQuery}}\&\ query)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordtype}{bool}\ latLong01ToSurface(}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector2}{math::Vector2R}}\&\ latLong01,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector3}{math::Vector3R}}\&\ observationPos,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_vector3}{math::Vector3R}}*\ out\_surface,}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_vector3}{math::Vector3R}}*\ out\_unitObservationDir)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{void}\ latLong01ToSurface(}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector2}{math::Vector2R}}\&\ latLong01,}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::array<real,\ 2>\&\ uniformSample,}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_vector3}{math::Vector3R}}*\ out\_surface,}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_vector3}{math::Vector3R}}*\ out\_unitObservationDir,}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ real*\ out\_pdfA)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_static_rigid_transform}{math::StaticRigidTransform}}*\ m\_localToWorld;}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_static_rigid_transform}{math::StaticRigidTransform}}*\ m\_worldToLocal;}
\DoxyCodeLine{00115\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_vector3}{math::Vector3R}}\ m\_worldOrigin;}
\DoxyCodeLine{00116\ \};}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a62efab606c54547ca10d717acee6b8b1}{PLatLongEnvSphere::mayOverlapVolume}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_a_a_b_b3_d}{math::AABB3D}}\&\ volume)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00119\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{comment}{//\ Rather\ than\ transforming\ \`{}volume`\ to\ local\ space,\ we\ transform\ the\ sphere\ to\ world\ space\ }}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ instead.\ Under\ static\ rigid\ transform\ the\ sphere\ shape\ is\ rotational\ invariant,\ we\ can\ }}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{comment}{//\ inversely\ translate\ \`{}volume`\ and\ test\ against\ the\ sphere\ at\ the\ origin}}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keyword}{auto}\ effectiveVolume\ =\ volume.\mbox{\hyperlink{classph_1_1math_1_1_t_a_a_b_b3_d_ab1a9510b332616e8d8987c3af36ffa54}{getTranslated}}(m\_worldOrigin.\mbox{\hyperlink{classph_1_1math_1_1_t_vector_n_base_a95415915a06f92953d0b06baba7a87f9}{negate}}());}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classph_1_1_p_basic_sphere_ab305a89c211275b48dad578131e56b7d}{PBasicSphere::mayOverlapVolume}}(effectiveVolume);}
\DoxyCodeLine{00125\ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classph_1_1math_1_1_t_a_a_b_b3_d}{math::AABB3D}}\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_ab365271a75cb844ac3bb3a1670812737}{PLatLongEnvSphere::calcAABB}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00128\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{comment}{//\ Under\ static\ rigid\ transform,\ only\ translation\ will\ matter\ to\ the\ AABB\ of\ a\ sphere}}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classph_1_1_p_basic_sphere_a75e188eb9cbc9915c9072e741495ec30}{PBasicSphere::calcAABB}}().\mbox{\hyperlink{classph_1_1math_1_1_t_a_a_b_b3_d_acf1d827e2e68aa0e6e7bd9372b6968b8}{translate}}(m\_worldOrigin);}
\DoxyCodeLine{00131\ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \textcolor{keyword}{inline}\ real\ \mbox{\hyperlink{classph_1_1_p_lat_long_env_sphere_a82ef3186774036a140db3979d63d76aa}{PLatLongEnvSphere::calcExtendedArea}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00134\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ Does\ not\ change\ under\ rigid\ transform}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classph_1_1_p_basic_sphere_aa4b4e2a2e02b90ffe5dab26cfed4e0c7}{PBasicSphere::calcExtendedArea}}();}
\DoxyCodeLine{00137\ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \}\textcolor{comment}{//\ end\ namespace\ ph}}

\end{DoxyCode}
