\doxysection{TBilinear\+Pixel\+Tex2\+D.\+h}
\hypertarget{_t_bilinear_pixel_tex2_d_8h_source}{}\label{_t_bilinear_pixel_tex2_d_8h_source}\index{Source/Core/Texture/TBilinearPixelTex2D.h@{Source/Core/Texture/TBilinearPixelTex2D.h}}
\mbox{\hyperlink{_t_bilinear_pixel_tex2_d_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_pixel_tex2_d_8h}{Core/Texture/TPixelTex2D.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_vector2_8h}{Math/TVector2.h}}"{}}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceph}{ph}}}
\DoxyCodeLine{00011\ \{}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T,\ std::\textcolor{keywordtype}{size\_t}\ N>}
\DoxyCodeLine{00014\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1_t_bilinear_pixel_tex2_d}{TBilinearPixelTex2D}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1_t_pixel_tex2_d}{TPixelTex2D}}<T,\ N>}
\DoxyCodeLine{00015\ \{}
\DoxyCodeLine{00016\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classph_1_1_t_pixel_tex2_d}{TPixelTex2D}}<T,\ N>\mbox{\hyperlink{classph_1_1_t_pixel_tex2_d_aa7b9952f81127647fe57fbc0331b4ce8}{::TPixelTex2D}};}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classph_1_1_t_bilinear_pixel_tex2_d_a03ec293b8eab6230bb9e7e1e6e7742a9}{sample}}(}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_sample_location}{SampleLocation}}\&\ \ sampleLocation,\ }
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TTexPixel<T,\ N>}}*\ \textcolor{keyword}{const}\ out\_value)\textcolor{keyword}{\ const\ override}}
\DoxyCodeLine{00022\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ u\ =\ sampleLocation.\mbox{\hyperlink{classph_1_1_sample_location_ac351e93a5024f7425c723f5852bb24e7}{uvw}}().\mbox{\hyperlink{classph_1_1math_1_1_t_vector3_a8d0eb557cecca2a3e07326c409b2c16b}{x}}();}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ v\ =\ sampleLocation.\mbox{\hyperlink{classph_1_1_sample_location_ac351e93a5024f7425c723f5852bb24e7}{uvw}}().\mbox{\hyperlink{classph_1_1math_1_1_t_vector3_a0a5f0880f6b82a8519416ca9a987818b}{y}}();}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\ \ w\ =\ this-\/>\mbox{\hyperlink{classph_1_1_t_abstract_pixel_tex2_d_a497f6bc3e9c4def7639d62a067b4b2b7}{getWidthPx}}();}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\ \ h\ =\ this-\/>\mbox{\hyperlink{classph_1_1_t_abstract_pixel_tex2_d_a6916d58f929e1a3e0e1ec7712da6a1a3}{getHeightPx}}();}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ PH\_ASSERT(w\ !=\ 0\ \&\&\ h\ !=\ 0);}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ float64\ normU,\ normV;}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classph_1_1_t_abstract_pixel_tex2_d_aef26a9364d7e3304333adb9a11fda94b}{normalizeUV}}(u,\ v,\ \&normU,\ \&normV);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ x\ \ =\ normU\ *\ w;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ y\ \ =\ normV\ *\ h;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ x0\ =\ std::floor(x\ -\/\ 0.5)\ +\ 0.5;}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ y0\ =\ std::floor(y\ -\/\ 0.5)\ +\ 0.5;}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ x1\ =\ x0\ +\ 1.0;}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ y1\ =\ y0\ +\ 1.0;}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ float64\ weights[4]}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ (x1\ -\/\ x)\ *\ (y1\ -\/\ y),\textcolor{comment}{//\ weight\ 00}}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ (x1\ -\/\ x)\ *\ (y\ -\/\ y0),\textcolor{comment}{//\ weight\ 01}}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ (x\ -\/\ x0)\ *\ (y1\ -\/\ y),\textcolor{comment}{//\ weight\ 10}}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ (x\ -\/\ x0)\ *\ (y\ -\/\ y0)\ \textcolor{comment}{//\ weight\ 11}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_vector2}{math::Vector2D}}\ xys[4]}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \{x0,\ y0\},\ \{x0,\ y1\},\ \{x1,\ y0\},\ \{x1,\ y1\}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TTexPixel<float64,\ N>}}\ accuPixel(0);}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TTexPixel<T,\ N>}}\ \ \ \ \ \ \ pixel;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(std::size\_t\ i\ =\ 0;\ i\ <\ 4;\ ++i)}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ float64\ normUi,\ normVi;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classph_1_1_t_abstract_pixel_tex2_d_aef26a9364d7e3304333adb9a11fda94b}{normalizeUV}}(xys[i].x()\ *\ this-\/>\mbox{\hyperlink{classph_1_1_t_abstract_pixel_tex2_d_a840741da611032a14c115abfdb3c7a1f}{getTexelSizeU}}(),}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xys[i].y()\ *\ this-\/>\mbox{\hyperlink{classph_1_1_t_abstract_pixel_tex2_d_a04a81e5579d8b1f1b32203f983e6239a}{getTexelSizeV}}(),}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&normUi,\ \&normVi);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\ xi\ =\ \textcolor{keyword}{static\_cast<}uint32\textcolor{keyword}{>}(normUi\ *\ w);}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ uint32\ yi\ =\ \textcolor{keyword}{static\_cast<}uint32\textcolor{keyword}{>}(normVi\ *\ h);}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ xi\ =\ xi\ <\ w\ ?\ xi\ :\ w\ -\/\ 1;}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ yi\ =\ yi\ <\ h\ ?\ yi\ :\ h\ -\/\ 1;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{classph_1_1_t_pixel_tex2_d_a2def8de26eae4beb7ed0f528e59b6678}{getPixel}}(xi,\ yi,\ \&pixel);}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ accuPixel.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TTexPixel<float64,\ N>}}(pixel).mulLocal(weights[i]));}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ taking\ care\ of\ pixel\ value\ rounding}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(std::is\_integral\_v<T>)}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ accuPixel.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(0.5);}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ *out\_value\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TTexPixel<T,\ N>}}(accuPixel);}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ \};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \}\textcolor{comment}{//\ end\ namespace\ ph}}

\end{DoxyCode}
