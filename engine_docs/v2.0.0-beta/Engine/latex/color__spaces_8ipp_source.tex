\doxysection{color\+\_\+spaces.\+ipp}
\hypertarget{color__spaces_8ipp_source}{}\label{color__spaces_8ipp_source}\index{Source/Math/Color/color\_spaces.ipp@{Source/Math/Color/color\_spaces.ipp}}
\mbox{\hyperlink{color__spaces_8ipp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{color__spaces_8h}{Math/Color/color\_spaces.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_matrix3_8h}{Math/TMatrix3.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{spectral__samples_8h}{Math/Color/spectral\_samples.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_i_uninstantiable_8h}{Utility/IUninstantiable.h}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{math__exceptions_8h}{Math/math\_exceptions.h}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_arithmetic_array_8h}{Math/TArithmeticArray.h}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{math_8h}{Math/math.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{chromatic__adaptations_8h}{Math/Color/chromatic\_adaptations.h}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <Common/assertion.h>}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceph_1_1math}{ph::math}}}
\DoxyCodeLine{00017\ \{}
\DoxyCodeLine{00018\ \ \ \ \ }
\DoxyCodeLine{00019\ \textcolor{keyword}{template}<EColorSpace\ COLOR\_SPACE,\ EReferenceWhite\ REF\_WHITE>}
\DoxyCodeLine{00020\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_helper}{TColorSpaceDefinitionHelper}}\ :\ \textcolor{keyword}{private}\ \mbox{\hyperlink{classph_1_1_i_uninstantiable}{IUninstantiable}}}
\DoxyCodeLine{00021\ \{}
\DoxyCodeLine{00022\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_helper_a6ead1f54a46c6ad6048244328f1fc0ce}{getColorSpace}}()\ noexcept}
\DoxyCodeLine{00024\ \ \ \ \ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ COLOR\_SPACE;}
\DoxyCodeLine{00026\ \ \ \ \ \}}
\DoxyCodeLine{00027\ \};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{template}<EColorSpace\ COLOR\_SPACE,\ EReferenceWhite\ REF\_WHITE>}
\DoxyCodeLine{00030\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper}{TTristimulusColorSpaceDefinitionHelper}}\ :\ \textcolor{keyword}{private}\ \mbox{\hyperlink{classph_1_1_i_uninstantiable}{IUninstantiable}}}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper_a5a9cbf8d653e7f6a17e3dc6f5bef25fc}{getColorSpace}}()\ noexcept}
\DoxyCodeLine{00034\ \ \ \ \ \{}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ COLOR\_SPACE;}
\DoxyCodeLine{00036\ \ \ \ \ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper_a88d568e02e3b8582124def84cfb3d97c}{isTristimulus}}()\ noexcept}
\DoxyCodeLine{00039\ \ \ \ \ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00041\ \ \ \ \ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \mbox{\hyperlink{namespaceph_1_1math_ac8bbf5c13da6b60663011e0be1acb6c4}{EReferenceWhite}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper_aa0a6b1d55a14bcb46af1bbb4fee43c75}{getReferenceWhite}}()\ noexcept}
\DoxyCodeLine{00044\ \ \ \ \ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ REF\_WHITE;}
\DoxyCodeLine{00046\ \ \ \ \ \}}
\DoxyCodeLine{00047\ \};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \textcolor{keyword}{template}<EColorSpace\ COLOR\_SPACE,\ EColorSpace\ BOUND\_TRISTIMULUS\_COLOR\_SPACE>}
\DoxyCodeLine{00050\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_spectral_color_space_definition_helper}{TSpectralColorSpaceDefinitionHelper}}\ :\ \textcolor{keyword}{private}\ \mbox{\hyperlink{classph_1_1_i_uninstantiable}{IUninstantiable}}}
\DoxyCodeLine{00051\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{static\_assert}(COLOR\_SPACE\ !=\ BOUND\_TRISTIMULUS\_COLOR\_SPACE,}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ define\ a\ spectral\ space\ that\ binds\ itself\ as\ a\ tristimulus\ one.\ "{}}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}A\ color\ space\ can\ be\ either\ spectral\ or\ tristimulus\ but\ not\ both."{}});}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_spectral_color_space_definition_helper_abc3ecacaa11ecc0d264e37add7d9f264}{getColorSpace}}()\ noexcept}
\DoxyCodeLine{00058\ \ \ \ \ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ COLOR\_SPACE;}
\DoxyCodeLine{00060\ \ \ \ \ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1math_1_1_t_spectral_color_space_definition_helper_aed34efb7593f58fb28de83b59715ae80}{isTristimulus}}()\ noexcept}
\DoxyCodeLine{00063\ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \textcolor{keyword}{consteval}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_spectral_color_space_definition_helper_aee56316692198f17e19d357d0d4056f5}{getBoundTristimulusColorSpace}}()\ noexcept}
\DoxyCodeLine{00068\ \ \ \ \ \{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BOUND\_TRISTIMULUS\_COLOR\_SPACE;}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00074\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition}}<\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}::\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975aa0722d9dcf7cc7b24ba4de9888238cfb}{CIE\_XYZ}},\ T>\ final\ :\ }
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper}{TTristimulusColorSpaceDefinitionHelper}}<EColorSpace::CIE\_XYZ,\ EReferenceWhite::D65>}
\DoxyCodeLine{00076\ \{}
\DoxyCodeLine{00077\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_c_i_e___x_y_z_00_01_t_01_4_a614a4f4539515d3a7ca307c9c88d2a95}{toCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ thisColor)}
\DoxyCodeLine{00079\ \ \ \ \ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Already\ in\ CIE-\/XYZ\ space,\ simply\ return\ the\ source\ color.}}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ thisColor;}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_c_i_e___x_y_z_00_01_t_01_4_a2103760170ea1e11d794b113a2ef2412}{fromCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ CIEXYZColor)}
\DoxyCodeLine{00085\ \ \ \ \ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Already\ in\ CIE-\/XYZ\ space,\ simply\ return\ the\ source\ color.}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ CIEXYZColor;}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ \};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00105\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00106\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition}}<\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}::\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a09459a025b9bd3e49c14a141f26f1168}{Linear\_sRGB}},\ T>\ final\ :}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper}{TTristimulusColorSpaceDefinitionHelper}}<EColorSpace::Linear\_sRGB,\ EReferenceWhite::D65>}
\DoxyCodeLine{00108\ \{}
\DoxyCodeLine{00109\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_linear__s_r_g_b_00_01_t_01_4_add536e3c48d2701dffaece4737011ddb}{toCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ thisColor)}
\DoxyCodeLine{00126\ \ \ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_matrix3}{TMatrix3<T>}}\ M(\mbox{\hyperlink{namespaceph_1_1math_a8013bb719cc5f01bbf14efd7f05ae955}{Matrix3D}}(}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ 0.41239079926595934,\ 0.357584339383878,\ \ \ 0.1804807884018343,}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ 0.21263900587151027,\ 0.715168678767756,\ \ \ 0.07219231536073371,}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ 0.01933081871559182,\ 0.11919477979462598,\ 0.9505321522496607));}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ M.\mbox{\hyperlink{classph_1_1math_1_1_t_matrix_mx_n_base_adb31940ade56da868f7b1834d6e3e22c}{multiplyVector}}(thisColor);}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_linear__s_r_g_b_00_01_t_01_4_ae6074639bb9c453c0f74f87f0357619a}{fromCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ CIEXYZColor)}
\DoxyCodeLine{00136\ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_matrix3}{TMatrix3<T>}}\ M(\mbox{\hyperlink{namespaceph_1_1math_a8013bb719cc5f01bbf14efd7f05ae955}{Matrix3D}}(}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ 3.2409699419045226,\ \ -\/1.537383177570094,\ \ -\/0.4986107602930034,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.9692436362808796,\ \ \ 1.8759675015077202,\ \ 0.04155505740717559,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.05563007969699366,\ -\/0.20397695888897652,\ 1.0569715142428786));}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ M.\mbox{\hyperlink{classph_1_1math_1_1_t_matrix_mx_n_base_adb31940ade56da868f7b1834d6e3e22c}{multiplyVector}}(CIEXYZColor);}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ \};}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00147\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition}}<\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}::\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a9ed33d9be17d174aeb4393a989586ed9}{sRGB}},\ T>\ final\ :}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper}{TTristimulusColorSpaceDefinitionHelper}}<EColorSpace::sRGB,\ EReferenceWhite::D65>}
\DoxyCodeLine{00149\ \{}
\DoxyCodeLine{00150\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ T\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1s_r_g_b_00_01_t_01_4_ae155e141850892d23b7c02c2b8c8d92c}{gammaCompressSingleChannel}}(\textcolor{keyword}{const}\ T\ linearColorValue)}
\DoxyCodeLine{00154\ \ \ \ \ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ PH\_ASSERT\_GE(linearColorValue,\ 0.0);}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ PH\_ASSERT\_LE(linearColorValue,\ 1.0);}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(linearColorValue\ <=\ 0.0031308)}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(12.92\ *\ linearColorValue);}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(1.055\ *\ std::pow(linearColorValue,\ 1.0\ /\ 2.4)\ -\/\ 0.055);}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ T\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1s_r_g_b_00_01_t_01_4_a9d51db220d9d2ad7f625bc6017b1fee5}{gammaExpandSingleChannel}}(\textcolor{keyword}{const}\ T\ nonlinearColorValue)}
\DoxyCodeLine{00169\ \ \ \ \ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ PH\_ASSERT\_GE(nonlinearColorValue,\ 0.0);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ PH\_ASSERT\_LE(nonlinearColorValue,\ 1.0);}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(nonlinearColorValue\ <=\ 0.04045)}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(nonlinearColorValue\ /\ 12.92);}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(std::pow((nonlinearColorValue\ +\ 0.055)\ /\ 1.055,\ 2.4));}
\DoxyCodeLine{00179\ \ \ \ \ \}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1s_r_g_b_00_01_t_01_4_a021401eab1f29b273a471c3b87b2242a}{gammaCompress}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ linearSRGBColor)}
\DoxyCodeLine{00184\ \ \ \ \ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ gammaCompressSingleChannel(linearSRGBColor[0]),\ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ gammaCompressSingleChannel(linearSRGBColor[1]),\ }
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ gammaCompressSingleChannel(linearSRGBColor[2])}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00191\ \ \ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1s_r_g_b_00_01_t_01_4_ae10fd3f069d89dab2f83365deb1fb091}{gammaExpand}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ nonlinearSRGBColor)}
\DoxyCodeLine{00196\ \ \ \ \ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ gammaExpandSingleChannel(nonlinearSRGBColor[0]),}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ gammaExpandSingleChannel(nonlinearSRGBColor[1]),}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ gammaExpandSingleChannel(nonlinearSRGBColor[2])}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00203\ \ \ \ \ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1s_r_g_b_00_01_t_01_4_a3cc3b3b7b40f9c66c394ff612b28ae1e}{toCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ thisColor)}
\DoxyCodeLine{00206\ \ \ \ \ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ linearSRGBColor\ =\ gammaExpand(thisColor);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<EColorSpace::Linear\_sRGB,\ T>::toCIEXYZ}}(linearSRGBColor);}
\DoxyCodeLine{00209\ \ \ \ \ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1s_r_g_b_00_01_t_01_4_ab96d9fdaf91982a92d2d0d8259ed902b}{fromCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ CIEXYZColor)}
\DoxyCodeLine{00212\ \ \ \ \ \{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ linearSRGBColor\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<EColorSpace::Linear\_sRGB,\ T>::fromCIEXYZ}}(CIEXYZColor);}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ gammaCompress(linearSRGBColor);}
\DoxyCodeLine{00215\ \ \ \ \ \}}
\DoxyCodeLine{00216\ \};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00219\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition}}<\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}::\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975ab6fb9dfbcbbcea21d6d2529b82d9903e}{CIE\_xyY}},\ T>\ final\ :}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper}{TTristimulusColorSpaceDefinitionHelper}}<EColorSpace::CIE\_xyY,\ EReferenceWhite::D65>}
\DoxyCodeLine{00221\ \{}
\DoxyCodeLine{00222\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_c_i_e__xy_y_00_01_t_01_4_a97ee7cececff5342329b5ff31a29208f}{toCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ thisColor)}
\DoxyCodeLine{00228\ \ \ \ \ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Negative\ luminance\ does\ not\ make\ sense\ (sucking\ light\ out\ of\ your\ eyeballs?\ hmmm),\ so\ we\ clamp\ to\ 0}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ x\ =\ thisColor[0];}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ y\ =\ thisColor[1];}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ Y\ =\ std::max(thisColor[2],\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0));}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(y\ !=\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0))}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ Y\_over\_y\ =\ Y\ /\ y;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Y\_over\_y\ *\ x,}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Y,\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Y\_over\_y\ *\ (\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(1)\ -\/\ x\ -\/\ y)}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ All\ zero\ for\ y\ =\ 0;}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ Colour\ python\ library\ returns\ (y,\ y,\ y)\ in\ this\ case\ (equivalent\ to\ our\ implementation)}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \{0.0,\ 0.0,\ 0.0\};}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_c_i_e__xy_y_00_01_t_01_4_a9de6cee5cb63049d4f33d183637101eb}{fromCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ CIEXYZColor)}
\DoxyCodeLine{00256\ \ \ \ \ \{}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ CIE\ XYZ\ color\ are\ defined\ to\ be\ non-\/negative,\ clamp\ negative\ values\ to\ 0}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ CIE\_X\ =\ std::max(CIEXYZColor[0],\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0));}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ CIE\_Y\ =\ std::max(CIEXYZColor[1],\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0));}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ CIE\_Z\ =\ std::max(CIEXYZColor[2],\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0));}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ sumXYZ\ =\ CIE\_X\ +\ CIE\_Y\ +\ CIE\_Z;}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ PH\_ASSERT\_GE(sumXYZ,\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0));}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(sumXYZ\ >\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0))}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ rcpSumXYZ\ =\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(1)\ /\ sumXYZ;}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ }
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CIE\_X\ *\ rcpSumXYZ,\textcolor{comment}{//\ x}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CIE\_Y\ *\ rcpSumXYZ,\textcolor{comment}{//\ y}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CIE\_Y\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Y\ (same\ as\ CIE\ XYZ's\ Y)}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ So\ the\ input\ XYZ\ color\ is\ black\ (X\ =\ Y\ =\ Z\ =\ 0)}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ In\ this\ case,\ we\ should\ return\ our\ reference\ white's\ chromaticity\ coordinates\ (xyY's\ xy),}}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ refWhiteChromaticity\ =\ \mbox{\hyperlink{namespaceph_1_1math_a4466b9f393d20ad035c33c30066ceec6}{chromaticity\_of<T>}}(getReferenceWhite());}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refWhiteChromaticity[0],}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ refWhiteChromaticity[1],}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0)\ \ \ \ \ \ \ \textcolor{comment}{//\ Y\ =\ 0\ as\ it\ is\ black}}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \ \ \ \ \}}
\DoxyCodeLine{00290\ \};}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00309\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00310\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition}}<\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}::\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a1cd2db83c1165ec3c7e7ca28694c92ee}{ACEScg}},\ T>\ final\ :}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1math_1_1_t_tristimulus_color_space_definition_helper}{TTristimulusColorSpaceDefinitionHelper}}<EColorSpace::ACEScg,\ EReferenceWhite::ACES>}
\DoxyCodeLine{00312\ \{}
\DoxyCodeLine{00313\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_a_c_e_scg_00_01_t_01_4_aef42d80544d577ca03610a30de49179f}{toCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ thisColor)}
\DoxyCodeLine{00315\ \ \ \ \ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ According\ to\ [4],\ this\ is\ the\ matrix\ for\ transformation\ from\ ACEScg\ (AP1)\ to\ CIE-\/XYZ}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_matrix3}{TMatrix3<T>}}\ M(\mbox{\hyperlink{namespaceph_1_1math_a8013bb719cc5f01bbf14efd7f05ae955}{Matrix3D}}(}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.6624541811,\ 0.1340042065,\ 0.1561876870,}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.2722287168,\ 0.6740817658,\ 0.0536895174,}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.0055746495,\ 0.0040607335,\ 1.0103391003));}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ M.\mbox{\hyperlink{classph_1_1math_1_1_t_matrix_mx_n_base_adb31940ade56da868f7b1834d6e3e22c}{multiplyVector}}(thisColor);}
\DoxyCodeLine{00323\ \ \ \ \ \}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_a_c_e_scg_00_01_t_01_4_a5c63e577f4c7f25d50be041633377263}{fromCIEXYZ}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ CIEXYZColor)}
\DoxyCodeLine{00326\ \ \ \ \ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ According\ to\ [4],\ this\ is\ the\ matrix\ for\ transformation\ from\ CIE-\/XYZ\ to\ ACEScg\ (AP1)}}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_matrix3}{TMatrix3<T>}}\ M(\mbox{\hyperlink{namespaceph_1_1math_a8013bb719cc5f01bbf14efd7f05ae955}{Matrix3D}}(}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ 1.6410233797,\ -\/0.3248032942,\ -\/0.2364246952,}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ -\/0.6636628587,\ \ 1.6153315917,\ \ 0.0167563477,}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0117218943,\ -\/0.0082844420,\ \ 0.9883948585));}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ M.\mbox{\hyperlink{classph_1_1math_1_1_t_matrix_mx_n_base_adb31940ade56da868f7b1834d6e3e22c}{multiplyVector}}(CIEXYZColor);}
\DoxyCodeLine{00334\ \ \ \ \ \}}
\DoxyCodeLine{00335\ \};}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \textcolor{keyword}{namespace\ }detail}
\DoxyCodeLine{00338\ \{}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T,\ CSpectralSampleProps\ SampleProps>}
\DoxyCodeLine{00341\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis}{TSmitsSPDBasis}}\ final}
\DoxyCodeLine{00342\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a287dac4946cecd76b8036d8948937004}{white}};}
\DoxyCodeLine{00344\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a55294e675b9f649ad55c76b7c13af00f}{cyan}};}
\DoxyCodeLine{00345\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ad0e607ef2516dc8a67187a4e79b22fd3}{magenta}};}
\DoxyCodeLine{00346\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a861db5563090d63af1d8dc65ee945653}{yellow}};}
\DoxyCodeLine{00347\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aeaad8b3a19ccb55ba3935b8ebd742817}{red}};}
\DoxyCodeLine{00348\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ae3ea5ff3465de0761058876666e97629}{green}};}
\DoxyCodeLine{00349\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ SampleProps::NUM\_SAMPLES>}}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aa54ee65e3563fc9c2cf53186b139c046}{blue}};}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a20cf2c03e48bba7566c6c140d72bf6b1}{TSmitsSPDBasis}}()}
\DoxyCodeLine{00352\ \ \ \ \ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construct\ sampled\ SPD\ bases\ for\ Smits'\ algorithm.}}
\DoxyCodeLine{00354\ \ \ \ \ }
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using\ }SmitsSPDValueType\ =\ spectral\_data::ArraySmits::value\_type;}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::size\_t\ NUM\_SMITS\_POINTS\ =\ std::tuple\_size\_v<spectral\_data::ArraySmits>;}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesWhite\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_a8c3dfc85eb86b5028068b0b59e8b5d30}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_white}}().data(),}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesCyan\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_a74b7ddb0f2504221f5ce278429268888}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_cyan}}().data(),}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesMagenta\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_a850a027a21c7b6b050a04bb46b9c717b}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_magenta}}().data(),}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesYellow\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_aedeca0937235ce764126d71f0ef54063}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_yellow}}().data(),}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesRed\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_a6a8aba26f7c9a123b6f4e2833375092c}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_red}}().data(),}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesGreen\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_a8d5f437bac2f1733c2c90e9ff8fe85c5}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_green}}().data(),}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ sampledValuesBlue\ =\ \mbox{\hyperlink{namespaceph_1_1math_a8ae6d9df536ec07a0411c503df56fee6}{resample\_spectral\_samples<T,\ SmitsSPDValueType,\ SampleProps>}}(}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_afaa615c1caaa9556d4c55defc925f383}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_wavelengths\_nm}}().data(),}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_1_1spectral__data_a083e7fac120e1c15f32c059ebfdb3f2e}{spectral\_data::smits\_linear\_sRGB\_to\_spectrum\_E\_blue}}().data(),}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ NUM\_SMITS\_POINTS);}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a287dac4946cecd76b8036d8948937004}{white}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesWhite);}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a55294e675b9f649ad55c76b7c13af00f}{cyan}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesCyan);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ad0e607ef2516dc8a67187a4e79b22fd3}{magenta}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesMagenta);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a861db5563090d63af1d8dc65ee945653}{yellow}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesYellow);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aeaad8b3a19ccb55ba3935b8ebd742817}{red}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesRed);}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ae3ea5ff3465de0761058876666e97629}{green}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesGreen);}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aa54ee65e3563fc9c2cf53186b139c046}{blue}}.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a66bef10def6b7cfc11adea52b28094e0}{set}}(sampledValuesBlue);}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ should\ we\ ensure\ bases\ sum\ to\ 1\ after\ being\ smapled?}}
\DoxyCodeLine{00402\ \ \ \ \ \}}
\DoxyCodeLine{00403\ \};}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \}\textcolor{comment}{//\ end\ namespace\ detail}}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00408\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition}}<\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}::\mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975ad105cc4d913228315335035aa21669a8}{Spectral\_Smits}},\ T>\ final\ :}
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{classph_1_1math_1_1_t_spectral_color_space_definition_helper}{TSpectralColorSpaceDefinitionHelper}}<EColorSpace::Spectral\_Smits,\ EColorSpace::Linear\_sRGB>}
\DoxyCodeLine{00410\ \{}
\DoxyCodeLine{00411\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_linear__s_r_g_b_00_01_t_01_4}{LinearSrgbDef}}\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<EColorSpace::Linear\_sRGB,\ T>}};}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a1b3bd4f6ba91a04531f5255c5412ff0b}{TSpectralSampleValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_spectral___smits_00_01_t_01_4_a2a8ea5258b437c3d3211cb79dd1acb19}{upSample}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ boundColor,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00416\ \ \ \ \ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis}{detail::TSmitsSPDBasis<T,\ DefaultSpectralSampleProps>}}\ basis;}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ r\ =\ boundColor[0];}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ g\ =\ boundColor[1];}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ T\ b\ =\ boundColor[2];}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ DefaultSpectralSampleProps::NUM\_SAMPLES>}}\ spd(0);}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ following\ steps\ mix\ in\ primary\ colors\ only\ as\ needed.\ Also,\ }}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (r,\ g,\ b)\ =\ (1,\ 1,\ 1)\ will\ be\ mapped\ to\ a\ constant\ SPD\ with\ }}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ magnitudes\ =\ 1.}}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ R\ is\ minimum}}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(r\ <=\ g\ \&\&\ r\ <=\ b)}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a287dac4946cecd76b8036d8948937004}{white}}\ *\ r);}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(g\ <=\ b)}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a55294e675b9f649ad55c76b7c13af00f}{cyan}}\ *\ (g\ -\/\ r));}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aa54ee65e3563fc9c2cf53186b139c046}{blue}}\ *\ (b\ -\/\ g));}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a55294e675b9f649ad55c76b7c13af00f}{cyan}}\ *\ (b\ -\/\ r));}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ae3ea5ff3465de0761058876666e97629}{green}}\ *\ (g\ -\/\ b));}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ G\ is\ minimum}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(g\ <=\ r\ \&\&\ g\ <=\ b)}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a287dac4946cecd76b8036d8948937004}{white}}\ *\ g);}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(r\ <=\ b)}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ad0e607ef2516dc8a67187a4e79b22fd3}{magenta}}\ *\ (r\ -\/\ g));}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aa54ee65e3563fc9c2cf53186b139c046}{blue}}\ *\ (b\ -\/\ r));}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ad0e607ef2516dc8a67187a4e79b22fd3}{magenta}}\ *\ (b\ -\/\ g));}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aeaad8b3a19ccb55ba3935b8ebd742817}{red}}\ *\ (r\ -\/\ b));}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ B\ is\ minimum}}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a287dac4946cecd76b8036d8948937004}{white}}\ *\ b);}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(r\ <=\ g)}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a861db5563090d63af1d8dc65ee945653}{yellow}}\ *\ (r\ -\/\ b));}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_ae3ea5ff3465de0761058876666e97629}{green}}\ *\ (g\ -\/\ r));}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_a861db5563090d63af1d8dc65ee945653}{yellow}}\ *\ (g\ -\/\ b));}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a87644527c2610a09cee0bcf0f2fb92e9}{addLocal}}(basis.\mbox{\hyperlink{structph_1_1math_1_1detail_1_1_t_smits_s_p_d_basis_aeaad8b3a19ccb55ba3935b8ebd742817}{red}}\ *\ (r\ -\/\ g));}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(LinearSrgbDef::getReferenceWhite()\ ==\ \mbox{\hyperlink{namespaceph_1_1math_ac8bbf5c13da6b60663011e0be1acb6c4a440c2a945f3a652a52ebefab6a30f515}{EReferenceWhite::D65}});}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ DefaultSpectralSampleProps::NUM\_SAMPLES>}}\ unitD65Spd(}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_ac3d128c7225063c77e89c60595769355}{resample\_illuminant\_D65<T>}}());}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(usage)}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ things\ such\ as\ illuminants,\ scale\ the\ SPD\ so\ that\ constant\ SPDs\ matches\ the\ distribution\ }}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ D65.\ This\ way,\ a\ "{}gray"{}\ linear-\/sRGB\ color\ will\ be\ D65\ scaled\ by\ some\ constant.\ Another\ way}}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\ think\ of\ it\ is\ we\ treat\ each\ component\ in\ the\ SPD\ as\ a\ scale\ value,\ and\ the\ resulting\ SPD}}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ simply\ a\ unit\ D65\ being\ scaled.}}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a8d4c0b2cef256d21ab680366c8b1c6bf}{EColorUsage::EMR}}:}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_ab2c2c0e821a2752db5eab046a8b945a3}{mulLocal}}(unitD65Spd);}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ things\ such\ as\ reflectances,\ make\ sure\ energy\ conservation\ requirements\ are\ met.}}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a13eb1af433fe09e8ee2e6b89001c3843}{EColorUsage::ECF}}:}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_ad2b8a87560ab65188ec7a7795eb4179d}{clampLocal}}(0,\ 1);}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a65e65c8ab0d8609ce12fc68a03cb8e00}{EColorUsage::Raw}}:}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ nothing}}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classph_1_1math_1_1_color_error}{ColorError}}(}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}A\ color\ usage\ must\ be\ specified\ when\ converting\ spectral\ color\ samples."{}});}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spd.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a4fc4de014adb7946df69ce2ca873d78c}{toArray}}();}
\DoxyCodeLine{00506\ \ \ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition_3_01_e_color_space_1_1_spectral___smits_00_01_t_01_4_ae6d808ac779c7a454911b4f6b82b66f9}{downSample}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a1b3bd4f6ba91a04531f5255c5412ff0b}{TSpectralSampleValues<T>}}\&\ sampleValues,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00509\ \ \ \ \ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ CIEXYZColor\ =\ \mbox{\hyperlink{namespaceph_1_1math_a4e8c5be354cae25f8639d0ebd4a9df17}{spectral\_samples\_to\_CIE\_XYZ}}(sampleValues,\ usage);}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ linearSrgbColor\ =\ LinearSrgbDef::fromCIEXYZ(CIEXYZColor);}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(usage\ ==\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a6fcdc090caeade09d0efd6253932b6f5}{EColorUsage::Unspecified}})}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classph_1_1math_1_1_color_error}{ColorError}}(}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}A\ color\ usage\ must\ be\ specified\ when\ converting\ spectral\ color\ samples."{}});}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ do\ not\ care\ about\ EMR\ color\ usage\ here\ since\ spectral\ samples\ should\ be\ independent\ of}}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reference\ whites.\ This\ may\ make\ round-\/trip\ conversions\ less\ stable\ (numerical\ error),\ }}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ think\ such\ stability\ is\ unimportant,\ however.\ We\ do\ nothing\ for\ RAW\ usage.\ }}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ }}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ ECF\ usage,\ we\ make\ sure\ the\ resulting\ value\ is\ well\ being\ in\ [0,\ 1].}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(usage\ ==\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a13eb1af433fe09e8ee2e6b89001c3843}{EColorUsage::ECF}})}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ linearSrgbColor\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ 3>}}(linearSrgbColor).\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_ad2b8a87560ab65188ec7a7795eb4179d}{clampLocal}}(0,\ 1).toArray();}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ linearSrgbColor;}
\DoxyCodeLine{00531\ \ \ \ \ \}}
\DoxyCodeLine{00532\ \};}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \textcolor{comment}{//\ End\ Color\ Space\ Definitions}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \textcolor{comment}{//\ Unspecified\ color\ space\ must\ not\ be\ a\ valid\ color\ space.}}
\DoxyCodeLine{00537\ \textcolor{keyword}{static\_assert}(!CColorSpaceDefinition<TColorSpaceDefinition<EColorSpace::Unspecified,\ float>,\ \textcolor{keywordtype}{float}>);}
\DoxyCodeLine{00538\ \textcolor{keyword}{static\_assert}(!CColorSpaceDefinition<TColorSpaceDefinition<EColorSpace::Unspecified,\ double>,\ \textcolor{keywordtype}{double}>);}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceph_1_1math_abe1a45b3ea4179b27954f963695cae32}{is\_tristimulus}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ colorSpace)}
\DoxyCodeLine{00541\ \{}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{keywordflow}{switch}(colorSpace)}
\DoxyCodeLine{00543\ \ \ \ \ \{}
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975aa0722d9dcf7cc7b24ba4de9888238cfb}{EColorSpace::CIE\_XYZ}}:}
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975ab6fb9dfbcbbcea21d6d2529b82d9903e}{EColorSpace::CIE\_xyY}}:}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a09459a025b9bd3e49c14a141f26f1168}{EColorSpace::Linear\_sRGB}}:}
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a9ed33d9be17d174aeb4393a989586ed9}{EColorSpace::sRGB}}:}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a1cd2db83c1165ec3c7e7ca28694c92ee}{EColorSpace::ACEScg}}:}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975a6fcdc090caeade09d0efd6253932b6f5}{EColorSpace::Unspecified}}:}
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975ad105cc4d913228315335035aa21669a8}{EColorSpace::Spectral\_Smits}}:}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ When\ failed,\ you\ may\ have\ added/removed\ some\ entries.\ Handle\ it\ in\ the\ above\ section.}}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ PH\_ASSERT\_UNREACHABLE\_SECTION();}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00559\ \ \ \ \ \}}
\DoxyCodeLine{00560\ \}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InColorValuesType,\ EColorSpace\ COLOR\_SPACE>}
\DoxyCodeLine{00563\ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{namespaceph_1_1math_a4f9e5426a4fdf63a119b6fac5a86eb98}{is\_compatible}}()}
\DoxyCodeLine{00564\ \{}
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keyword}{using\ }ColorValuesType\ =\ std::remove\_cvref\_t<InColorValuesType>;}
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keyword}{using\ }ElementType\ =\ \mbox{\hyperlink{namespaceph_1_1math_1_1detail_a8492cfad9239c735abb040def1c6deea}{detail::TColorValuesElementType<ColorValuesType>}};}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(std::is\_same\_v<ElementType,\ void>)}
\DoxyCodeLine{00568\ \ \ \ \ \{}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00570\ \ \ \ \ \}}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \ \ \textcolor{keyword}{using\ }ColorSpaceDef\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<COLOR\_SPACE,\ ElementType>}};}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ REQUIRED\_SIZE\ =\ ColorSpaceDef::isTristimulus()}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ ?\ std::tuple\_size\_v<TTristimulusValues<ElementType>>}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ :\ std::tuple\_size\_v<TSpectralSampleValues<ElementType>>;}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(\mbox{\hyperlink{conceptph_1_1math_1_1_c_color_values_interface}{CColorValuesInterface<ColorValuesType>}})}
\DoxyCodeLine{00579\ \ \ \ \ \{}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::tuple\_size\_v<decltype(std::declval<ColorValuesType>().getColorValues())>\ ==\ REQUIRED\_SIZE;}
\DoxyCodeLine{00581\ \ \ \ \ \}}
\DoxyCodeLine{00582\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00583\ \ \ \ \ \{}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::tuple\_size\_v<ColorValuesType>\ ==\ REQUIRED\_SIZE;}
\DoxyCodeLine{00585\ \ \ \ \ \}}
\DoxyCodeLine{00586\ \}}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ EColorSpace\ DST\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T,\ EChromaticAdaptation\ ALGORITHM>}
\DoxyCodeLine{00589\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00590\ \{}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{comment}{//\ No\ conversion\ needed\ if\ they\ are\ in\ the\ same\ color\ space}}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SRC\_COLOR\_SPACE\ ==\ DST\_COLOR\_SPACE)}
\DoxyCodeLine{00593\ \ \ \ \ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ srcColorValues;}
\DoxyCodeLine{00595\ \ \ \ \ \}}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keyword}{using\ }SrcColorSpaceDef\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<SRC\_COLOR\_SPACE,\ T>}};}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keyword}{using\ }DstColorSpaceDef\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<DST\_COLOR\_SPACE,\ T>}};}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{comment}{//\ Sanity\ checks}}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{conceptph_1_1math_1_1_c_color_space_definition}{CColorSpaceDefinition<SrcColorSpaceDef,\ T>}},}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Source\ color\ space\ has\ no\ corresponding\ definition."{}});}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keyword}{static\_assert}(\mbox{\hyperlink{conceptph_1_1math_1_1_c_color_space_definition}{CColorSpaceDefinition<DstColorSpaceDef,\ T>}},}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Destination\ color\ space\ has\ no\ corresponding\ definition."{}});}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{comment}{//\ Type\ of\ source\ color\ values\ must\ match\ the\ category\ of\ its\ color\ space}}
\DoxyCodeLine{00609\ \ \ \ \ \textcolor{keyword}{using\ }SrcColorValues\ =\ std::remove\_cvref\_t<\textcolor{keyword}{decltype}(srcColorValues)>;}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00611\ \ \ \ \ \{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_same\_v<SrcColorValues,\ TTristimulusValues<T>>);}
\DoxyCodeLine{00613\ \ \ \ \ \}}
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00615\ \ \ \ \ \{}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_same\_v<SrcColorValues,\ TSpectralSampleValues<T>>);}
\DoxyCodeLine{00617\ \ \ \ \ \}}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{comment}{//\ There\ are\ 4\ possible\ conversion\ scenarios,\ we\ process\ them\ case\ by\ case:}}
\DoxyCodeLine{00620\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ To\ \ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{comment}{//\ \ From\ \ \ \ \ \ \ \ \ \ \ \ \ |\ tristimulus\ (T)\ |\ spectral\ \ \ \ (S)\ |}}
\DoxyCodeLine{00623\ \ \ \ \ \textcolor{comment}{//\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00624\ \ \ \ \ \textcolor{comment}{//\ |\ tristimulus\ (T)\ |\ \ \ \ \ T\ -\/-\/>\ T\ \ \ \ \ |\ \ \ \ \ T\ -\/-\/>\ S\ \ \ \ \ |}}
\DoxyCodeLine{00625\ \ \ \ \ \textcolor{comment}{//\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{comment}{//\ |\ spectral\ \ \ \ (S)\ |\ \ \ \ \ S\ -\/-\/>\ T\ \ \ \ \ |\ \ \ \ \ S\ -\/-\/>\ S\ \ \ \ \ |}}
\DoxyCodeLine{00627\ \ \ \ \ \textcolor{comment}{//\ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/+}}
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{comment}{//\ Case\ 1:\ S\ -\/-\/>\ S,\ just\ copy\ \&\ return\ the\ color\ samples\ as\ spectral\ samples\ are\ already\ in\ a\ }}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ color-\/space\ neutral\ representation.\ }}
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(!SrcColorSpaceDef::isTristimulus()\ \&\&\ !DstColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00633\ \ \ \ \ \{}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(usage\ ==\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a6fcdc090caeade09d0efd6253932b6f5}{EColorUsage::Unspecified}})}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classph_1_1math_1_1_color_error}{ColorError}}(}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}A\ color\ usage\ must\ be\ specified\ when\ converting\ spectral\ color\ samples."{}});}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ ECF\ usage,\ we\ make\ sure\ the\ resulting\ value\ is\ well\ being\ in\ [0,\ 1].\ }}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(usage\ ==\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a13eb1af433fe09e8ee2e6b89001c3843}{EColorUsage::ECF}})}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ DefaultSpectralSampleProps::NUM\_SAMPLES>}}\ copiedSamples(srcColorValues);}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ copiedSamples.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_ad2b8a87560ab65188ec7a7795eb4179d}{clampLocal}}(0,\ 1);}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ copiedSamples.\mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array_base_a4fc4de014adb7946df69ce2ca873d78c}{toArray}}();}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ do\ not\ care\ for\ other\ usages\ as\ they\ have\ no\ hard\ requirements\ on\ sample\ values.}}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ srcColorValues;}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00652\ \ \ \ \ \}}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{comment}{//\ Case\ 2:\ T\ -\/-\/>\ S,\ convert\ input\ tristimulus\ values\ to\ dst's\ bound\ space\ first\ (a\ T\ -\/-\/>\ T\ case),}}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ then\ perform\ an\ up\ sample.}}
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::isTristimulus()\ \&\&\ !DstColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00657\ \ \ \ \ \{}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ BOUND\_COLOR\_SPACE\ =\ DstColorSpaceDef::getBoundTristimulusColorSpace();}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ boundColor\ =\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<SRC\_COLOR\_SPACE,\ BOUND\_COLOR\_SPACE,\ T,\ ALGORITHM>}}(}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ srcColorValues,\ usage);}
\DoxyCodeLine{00662\ \ \ \ \ }
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DstColorSpaceDef::upSample(boundColor,\ usage);}
\DoxyCodeLine{00664\ \ \ \ \ \}}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{comment}{//\ Case\ 3:\ S\ -\/-\/>\ T,\ down\ sample\ input\ spectral\ samples\ to\ src's\ bound\ space\ first,\ then\ convert}}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ the\ bound\ color\ to\ dst\ space\ (a\ T\ -\/-\/>\ T\ case).}}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(!SrcColorSpaceDef::isTristimulus()\ \&\&\ DstColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00669\ \ \ \ \ \{}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ boundColor\ =\ SrcColorSpaceDef::downSample(srcColorValues,\ usage);}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{namespaceph_1_1math_a957eab3ceed525ebce5c24b6b57eb975}{EColorSpace}}\ BOUND\_COLOR\_SPACE\ =\ SrcColorSpaceDef::getBoundTristimulusColorSpace();}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<BOUND\_COLOR\_SPACE,\ DST\_COLOR\_SPACE,\ T,\ ALGORITHM>}}(}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ boundColor,\ usage);}
\DoxyCodeLine{00676\ \ \ \ \ \}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{comment}{//\ Case\ 4:\ T\ -\/-\/>\ T,\ perform\ color\ conversion\ by\ using\ CIE\ XYZ\ as\ an\ intermediate\ space}}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::isTristimulus()\ \&\&\ DstColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00680\ \ \ \ \ \{}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ to\ CIE\ XYZ\ first}}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ srcCIEXYZColor\ =\ SrcColorSpaceDef::toCIEXYZ(srcColorValues);}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Perform\ chromatic\ adaptation\ if\ needed}}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::getReferenceWhite()\ !=\ DstColorSpaceDef::getReferenceWhite())}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ srcCIEXYZColor\ =\ \mbox{\hyperlink{namespaceph_1_1math_a57a79918ca16800547722e927119aa60}{chromatic\_adapt<ALGORITHM,\ T>}}(}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ srcCIEXYZColor,}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SrcColorSpaceDef::getReferenceWhite(),}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DstColorSpaceDef::getReferenceWhite());}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Finally,\ convert\ to\ the\ destination\ color\ space}}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DstColorSpaceDef::fromCIEXYZ(srcCIEXYZColor);}
\DoxyCodeLine{00695\ \ \ \ \ \}}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \ \ PH\_ASSERT\_UNREACHABLE\_SECTION();}
\DoxyCodeLine{00698\ \}}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T,\ EChromaticAdaptation\ ALGORITHM>}
\DoxyCodeLine{00701\ \textcolor{keyword}{inline}\ T\ \mbox{\hyperlink{namespaceph_1_1math_a2982839b6392253fc67bb096add9a44f}{relative\_luminance}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00702\ \{}
\DoxyCodeLine{00703\ \ \ \ \ \textcolor{keyword}{using\ }SrcColorSpaceDef\ \ \ \ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<SRC\_COLOR\_SPACE,\ T>}};}
\DoxyCodeLine{00704\ \ \ \ \ \textcolor{keyword}{using\ }CIEXYZColorSpaceDef\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<EColorSpace::CIE\_XYZ,\ T>}};}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \ \ T\ relativeLuminance;}
\DoxyCodeLine{00707\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00708\ \ \ \ \ \{}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ transform\ input\ color\ values\ into\ CIE-\/XYZ\ color\ space}}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ CIEXYZColor\ =\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<SRC\_COLOR\_SPACE,\ EColorSpace::CIE\_XYZ,\ T,\ ALGORITHM>}}(}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ srcColorValues,\ usage);}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ Y\ component\ should\ be\ the\ relative\ luminance.\ However,\ we\ would\ like\ to\ know\ relative\ luminance}}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ with\ respect\ to\ source\ color\ space's\ reference\ white.\ Perform\ a\ chromatic\ adaptation\ if\ required}}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::getReferenceWhite()\ !=\ CIEXYZColorSpaceDef::getReferenceWhite())}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ CIEXYZColor\ =\ \mbox{\hyperlink{namespaceph_1_1math_a57a79918ca16800547722e927119aa60}{chromatic\_adapt<ALGORITHM,\ T>}}(}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CIEXYZColor,}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CIEXYZColorSpaceDef::getReferenceWhite(),}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SrcColorSpaceDef::getReferenceWhite());}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ relativeLuminance\ =\ CIEXYZColor[1];}
\DoxyCodeLine{00724\ \ \ \ \ \}}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00726\ \ \ \ \ \{}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ spectral\ samples,\ we\ do\ not\ transform\ into\ CIE-\/XYZ,\ since\ in\ our\ implementation\ the\ conversion}}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ be\ associated\ with\ a\ reference\ white\ which\ is\ unnecessary.}}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ CIEXYZColor\ =\ \mbox{\hyperlink{namespaceph_1_1math_a4e8c5be354cae25f8639d0ebd4a9df17}{spectral\_samples\_to\_CIE\_XYZ}}(srcColorValues,\ usage);}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ relativeLuminance\ =\ CIEXYZColor[1];}
\DoxyCodeLine{00732\ \ \ \ \ \}}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{comment}{//\ Ensure\ energy\ conservation\ if\ the\ usage\ is\ ECF}}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{if}(usage\ ==\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a13eb1af433fe09e8ee2e6b89001c3843}{EColorUsage::ECF}})}
\DoxyCodeLine{00736\ \ \ \ \ \{}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ relativeLuminance\ =\ \mbox{\hyperlink{namespaceph_1_1math_af8f390358e5ac8042dde889f48d9aaa4}{clamp<T>}}(relativeLuminance,\ 0,\ 1);}
\DoxyCodeLine{00738\ \ \ \ \ \}}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{keywordflow}{return}\ relativeLuminance;}
\DoxyCodeLine{00741\ \}}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T,\ EColorSpace\ SPECTRAL\_COLOR\_SPACE,\ EChromaticAdaptation\ ALGORITHM>}
\DoxyCodeLine{00744\ \textcolor{keyword}{inline}\ T\ \mbox{\hyperlink{namespaceph_1_1math_a2b0482067dc614d1eeafbf75b8b10996}{estimate\_color\_energy}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues)}
\DoxyCodeLine{00745\ \{}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keyword}{using\ }SrcColorSpaceDef\ \ \ \ \ \ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<SRC\_COLOR\_SPACE,\ T>}};}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keyword}{using\ }SpectralColorSpaceDef\ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<SPECTRAL\_COLOR\_SPACE,\ T>}};}
\DoxyCodeLine{00748\ }
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{keyword}{static\_assert}(!SpectralColorSpaceDef::isTristimulus(),}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SPECTRAL\_COLOR\_SPACE\ must\ be\ a\ spectral\ color\ space."{}});}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_a1b3bd4f6ba91a04531f5255c5412ff0b}{TSpectralSampleValues<T>}}\ sampleValues;}
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(SrcColorSpaceDef::isTristimulus())}
\DoxyCodeLine{00754\ \ \ \ \ \{}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ sampleValues\ =\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<SRC\_COLOR\_SPACE,\ SPECTRAL\_COLOR\_SPACE,\ T,\ ALGORITHM>}}(}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ srcColorValues,\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067a8d4c0b2cef256d21ab680366c8b1c6bf}{EColorUsage::EMR}});}
\DoxyCodeLine{00757\ \ \ \ \ \}}
\DoxyCodeLine{00758\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00759\ \ \ \ \ \{}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ sampleValues\ =\ srcColorValues;}
\DoxyCodeLine{00761\ \ \ \ \ \}}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceph_1_1math_aab219259171b1d3575da2b5224edcb93}{estimate\_samples\_energy}}(sampleValues);}
\DoxyCodeLine{00764\ \}}
\DoxyCodeLine{00765\ }
\DoxyCodeLine{00766\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T,\ EColorSpace\ SPECTRAL\_COLOR\_SPACE,\ EChromaticAdaptation\ ALGORITHM>}
\DoxyCodeLine{00767\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceph_1_1math_aaaa5875dae95653f7145e11b81e90459}{normalize\_color\_energy}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues)}
\DoxyCodeLine{00768\ \{}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{keyword}{const}\ T\ energy\ =\ \mbox{\hyperlink{namespaceph_1_1math_a2b0482067dc614d1eeafbf75b8b10996}{estimate\_color\_energy<SRC\_COLOR\_SPACE,\ T,\ SPECTRAL\_COLOR\_SPACE,\ ALGORITHM>}}(}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ srcColorValues);}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keyword}{using\ }SrcColorValues\ =\ std::remove\_cvref\_t<\textcolor{keyword}{decltype}(srcColorValues)>;}
\DoxyCodeLine{00773\ \ \ \ \ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ std::tuple\_size\_v<SrcColorValues>}}>\ copiedSrcColorValues(srcColorValues);}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{keywordflow}{if}(energy\ >\ 0)}
\DoxyCodeLine{00775\ \ \ \ \ \{}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ copiedSrcColorValues\ /=\ energy;}
\DoxyCodeLine{00777\ \ \ \ \ \}}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \ \ \textcolor{keywordflow}{return}\ copiedSrcColorValues.toArray();}
\DoxyCodeLine{00780\ \}}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T,\ EColorSpace\ SPECTRAL\_COLOR\_SPACE,\ EChromaticAdaptation\ ALGORITHM>}
\DoxyCodeLine{00783\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceph_1_1math_a036e6132c8c8a769c292f29b8427112b}{put\_color\_energy}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues,\ \textcolor{keyword}{const}\ T\ energyLevel)}
\DoxyCodeLine{00784\ \{}
\DoxyCodeLine{00785\ \ \ \ \ \textcolor{keyword}{using\ }SrcColorValues\ =\ std::remove\_cvref\_t<\textcolor{keyword}{decltype}(srcColorValues)>;}
\DoxyCodeLine{00786\ \ \ \ \ \textcolor{keyword}{using\ }ArrayType\ \ \ \ \ \ =\ \mbox{\hyperlink{classph_1_1math_1_1_t_arithmetic_array}{TArithmeticArray<T,\ std::tuple\_size\_v<SrcColorValues>}}>;}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keyword}{const}\ ArrayType\ energyNormalizedColor(}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceph_1_1math_aaaa5875dae95653f7145e11b81e90459}{normalize\_color\_energy<SRC\_COLOR\_SPACE,\ T,\ SPECTRAL\_COLOR\_SPACE,\ ALGORITHM>}}(srcColorValues));}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \ \textcolor{keywordflow}{return}\ (energyNormalizedColor\ *\ ArrayType(energyLevel)).toArray();}
\DoxyCodeLine{00792\ \}}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00795\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{namespaceph_1_1math_af073289717f681f13febdf1888d38d5b}{sRGB\_nonlinear\_to\_linear}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ nonlinearSRGB)}
\DoxyCodeLine{00796\ \{}
\DoxyCodeLine{00797\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<EColorSpace::sRGB,\ T>::gammaExpand}}(nonlinearSRGB);}
\DoxyCodeLine{00798\ \}}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00801\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{namespaceph_1_1math_ad70f4b84a56b15f96d640ee5dfe83c58}{sRGB\_linear\_to\_nonlinear}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ linearSRGB)}
\DoxyCodeLine{00802\ \{}
\DoxyCodeLine{00803\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classph_1_1math_1_1_t_color_space_definition}{TColorSpaceDefinition<EColorSpace::sRGB,\ T>::gammaCompress}}(linearSRGB);}
\DoxyCodeLine{00804\ \}}
\DoxyCodeLine{00805\ }
\DoxyCodeLine{00806\ \textcolor{keyword}{template}<EColorSpace\ DST\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00807\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceph_1_1math_a4b760ffa2dd0b2fb8b0c477fffd7c097}{transform\_from\_sRGB}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ nonlinearSRGB,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00808\ \{}
\DoxyCodeLine{00809\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<EColorSpace::sRGB,\ DST\_COLOR\_SPACE,\ T>}}(}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ nonlinearSRGB,\ usage);}
\DoxyCodeLine{00811\ \}}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \textcolor{keyword}{template}<EColorSpace\ DST\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00814\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceph_1_1math_a9d227a2cbf1065eaa4e4b5d51d71f30c}{transform\_from\_linear\_sRGB}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\&\ linearSRGB,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00815\ \{}
\DoxyCodeLine{00816\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<EColorSpace::Linear\_sRGB,\ DST\_COLOR\_SPACE,\ T>}}(}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ linearSRGB,\ usage);}
\DoxyCodeLine{00818\ \}}
\DoxyCodeLine{00819\ }
\DoxyCodeLine{00820\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00821\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{namespaceph_1_1math_ad3164ab55096d5ac1fd9a7158c8ea6d4}{transform\_to\_sRGB}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00822\ \{}
\DoxyCodeLine{00823\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<SRC\_COLOR\_SPACE,\ EColorSpace::sRGB,\ T>}}(}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ srcColorValues,\ usage);}
\DoxyCodeLine{00825\ \}}
\DoxyCodeLine{00826\ }
\DoxyCodeLine{00827\ \textcolor{keyword}{template}<EColorSpace\ SRC\_COLOR\_SPACE,\ \textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00828\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespaceph_1_1math_a9d9c64dd71192e59bad3d1a729ce7e68}{TTristimulusValues<T>}}\ \mbox{\hyperlink{namespaceph_1_1math_a9a607a63db401274a7e3d77c0895dcaf}{transform\_to\_linear\_sRGB}}(\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ srcColorValues,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceph_1_1math_a821af6da20aaed56cc09ad440633d067}{EColorUsage}}\ usage)}
\DoxyCodeLine{00829\ \{}
\DoxyCodeLine{00830\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespaceph_1_1math_a57a6066f091fead6bc616fb811b42b21}{transform\_color<SRC\_COLOR\_SPACE,\ EColorSpace::Linear\_sRGB,\ T>}}(}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ srcColorValues,\ usage);}
\DoxyCodeLine{00832\ \}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \}\textcolor{comment}{//\ end\ namespace\ ph::math}}

\end{DoxyCode}
