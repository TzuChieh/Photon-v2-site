\doxysection{Surface\+Tracer.\+h}
\hypertarget{_surface_tracer_8h_source}{}\label{_surface_tracer_8h_source}\index{Source/Core/LTABuildingBlock/SurfaceTracer.h@{Source/Core/LTABuildingBlock/SurfaceTracer.h}}
\mbox{\hyperlink{_surface_tracer_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_i_move_only_8h}{Utility/IMoveOnly.h}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_scene_8h}{World/Scene.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_hit_probe_8h}{Core/HitProbe.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_surface_hit_8h}{Core/SurfaceHit.h}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_sidedness_agreement_8h}{Core/LTABuildingBlock/SidednessAgreement.h}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_bsdf_sample_query_8h}{Core/SurfaceBehavior/BsdfSampleQuery.h}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_bsdf_eval_query_8h}{Core/SurfaceBehavior/BsdfEvalQuery.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_bsdf_pdf_query_8h}{Core/SurfaceBehavior/BsdfPdfQuery.h}}"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_ray_8h}{Core/Ray.h}}"{}}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_t_vector3_8h}{Math/TVector3.h}}"{}}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_primitive_8h}{Core/Intersectable/Primitive.h}}"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_primitive_metadata_8h}{Core/Intersectable/PrimitiveMetadata.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_surface_behavior_8h}{Core/SurfaceBehavior/SurfaceBehavior.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_surface_optics_8h}{Core/SurfaceBehavior/SurfaceOptics.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <Common/assertion.h>}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceph}{ph}}}
\DoxyCodeLine{00023\ \{}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }SampleFlow;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classph_1_1_surface_tracer}{SurfaceTracer}}\ final\ :\ \textcolor{keyword}{private}\ \mbox{\hyperlink{classph_1_1_i_move_only}{IMoveOnly}}}
\DoxyCodeLine{00028\ \{}
\DoxyCodeLine{00029\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classph_1_1_surface_tracer}{SurfaceTracer}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_scene}{Scene}}*\ scene);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a49cb61b1569526ebc37a0d4a1d7d73f3}{traceNextSurface}}(}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_ray}{Ray}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ray,\ }
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_sidedness_agreement}{SidednessAgreement}}\&\ sidedness,\ }
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\_X)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a0bbf88faf676c251b3ae89d2df51b97f}{doBsdfSample}}(}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_bsdf_sample_query}{BsdfSampleQuery}}\&\ bsdfSample,}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_sample_flow}{SampleFlow}}\&\ \ \ \ \ \ sampleFlow,}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classph_1_1_ray}{Ray}}*\ \ \ \ \ \ \ \ \ \ \ \ \ out\_ray)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a0a3a624ab60abac6864c77cc8a8482a9}{doBsdfEvaluation}}(\mbox{\hyperlink{classph_1_1_bsdf_eval_query}{BsdfEvalQuery}}\&\ bsdfEval)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a1c9ab40820e749ead9ddd211bedf5c19}{doBsdfPdfQuery}}(\mbox{\hyperlink{classph_1_1_bsdf_pdf_query}{BsdfPdfQuery}}\&\ bsdfPdfQuery)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00044\ \ \ \ \ }
\DoxyCodeLine{00045\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_scene}{Scene}}*\ m\_scene;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_optics}{SurfaceOptics}}*\ getSurfaceOptics(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}\&\ X);}
\DoxyCodeLine{00049\ \};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{comment}{//\ In-\/header\ Implementations:}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_optics}{SurfaceOptics}}*\ SurfaceTracer::getSurfaceOptics(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}\&\ X)}
\DoxyCodeLine{00054\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \textcolor{keyword}{const}\ metadata\ =\ X.\mbox{\hyperlink{classph_1_1_surface_hit_a796492b34ec40eb78da4b70c287b26d6}{getDetail}}().\mbox{\hyperlink{classph_1_1_hit_detail_a4227114111e5325f96dfdc83e8a98da3}{getPrimitive}}()-\/>\mbox{\hyperlink{classph_1_1_primitive_a967b40614b286c46aed37e9cd81fec0e}{getMetadata}}();}
\DoxyCodeLine{00056\ \ \ \ \ PH\_ASSERT(metadata);}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}*\ \textcolor{keyword}{const}\ optics\ =\ metadata-\/>getSurface().getOptics();}
\DoxyCodeLine{00059\ \ \ \ \ PH\_ASSERT(optics);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordflow}{return}\ optics;}
\DoxyCodeLine{00062\ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a1c57227d41a615b998f4c5d8e2546e8a}{SurfaceTracer::SurfaceTracer}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_scene}{Scene}}*\ \textcolor{keyword}{const}\ scene)\ :}
\DoxyCodeLine{00065\ \ \ \ \ m\_scene(scene)}
\DoxyCodeLine{00066\ \{}
\DoxyCodeLine{00067\ \ \ \ \ PH\_ASSERT(scene);}
\DoxyCodeLine{00068\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a49cb61b1569526ebc37a0d4a1d7d73f3}{SurfaceTracer::traceNextSurface}}(}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_ray}{Ray}}\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ray,}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_sidedness_agreement}{SidednessAgreement}}\&\ sidedness,}
\DoxyCodeLine{00073\ \ \ \ \ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}*\ \textcolor{keyword}{const}\ \ \ \ \ \ \ \ \ out\_X)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00074\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00075\ \ \ \ \ PH\_ASSERT(m\_scene);}
\DoxyCodeLine{00076\ \ \ \ \ PH\_ASSERT(out\_X);}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{classph_1_1_hit_probe}{HitProbe}}\ probe;}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{if}(!m\_scene-\/>\mbox{\hyperlink{classph_1_1_scene_a5a7a34b8af81678644090d368e46eae9}{isIntersecting}}(ray,\ \&probe))}
\DoxyCodeLine{00080\ \ \ \ \ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ *out\_X\ =\ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}(ray,\ probe);}
\DoxyCodeLine{00085\ \ \ \ \ sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_aaf14e63820d81c2aad99d7e0056c8377}{adjustForSidednessAgreement}}(*out\_X);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordflow}{return}\ sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(*out\_X,\ ray.\mbox{\hyperlink{classph_1_1_ray_a3f62b201c0015a647611282280130b52}{getDirection}}());}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a0bbf88faf676c251b3ae89d2df51b97f}{SurfaceTracer::doBsdfSample}}(}
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{classph_1_1_bsdf_sample_query}{BsdfSampleQuery}}\&\ bsdfSample,\ }
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{classph_1_1_sample_flow}{SampleFlow}}\&\ \ \ \ \ \ sampleFlow,\ }
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{classph_1_1_ray}{Ray}}*\ \textcolor{keyword}{const}\ \ \ \ \ \ \ out\_ray)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00094\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00095\ \ \ \ \ PH\_ASSERT(m\_scene);}
\DoxyCodeLine{00096\ \ \ \ \ PH\_ASSERT(out\_ray);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}\&\ \ \ \ \ \ \ \ \ X\ \ \ \ \ \ \ \ \ =\ bsdfSample.\mbox{\hyperlink{classph_1_1_bsdf_sample_query_a15de1880de1bfef9ac195e1f7c072164}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_sample_input_af7fedff4c4025eebee0f918eaac000f6}{X}};}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_sidedness_agreement}{SidednessAgreement}}\&\ sidedness\ =\ bsdfSample.\mbox{\hyperlink{classph_1_1_bsdf_sample_query_a1bfaa61482d5266d1e8fe1f0dfd3b372}{context}}.\mbox{\hyperlink{classph_1_1_bsdf_query_context_a4019270743658c949cc413403182f1e9}{sidedness}};}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{if}(!X.\mbox{\hyperlink{classph_1_1_surface_hit_a5aa56bbfe581343becbdd2f3f7c89d66}{hasSurfaceOptics}}()\ ||\ }
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ !sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(X,\ bsdfSample.\mbox{\hyperlink{classph_1_1_bsdf_sample_query_a15de1880de1bfef9ac195e1f7c072164}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_sample_input_ad1ef19ba8fc42f61ad398bc7b6561c86}{V}}))}
\DoxyCodeLine{00103\ \ \ \ \ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ getSurfaceOptics(X)-\/>\mbox{\hyperlink{classph_1_1_surface_optics_aedd40a9bb65f592940538623d1acbcbd}{calcBsdfSample}}(bsdfSample,\ sampleFlow);}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ HACK:\ hard-\/coded\ number}}
\DoxyCodeLine{00110\ \ \ \ \ *out\_ray\ =\ \mbox{\hyperlink{classph_1_1_ray}{Ray}}(X.\mbox{\hyperlink{classph_1_1_surface_hit_ab9436d2c3f6530722d402edb487f87f1}{getPosition}}(),\ bsdfSample.\mbox{\hyperlink{classph_1_1_bsdf_sample_query_ae5f5dce90d4b33005528d3725d8f2ede}{outputs}}.\mbox{\hyperlink{classph_1_1_bsdf_sample_output_a3b6bf50417a3d5c14ffa49ed470509a9}{L}},\ 0.0001\_r,\ std::numeric\_limits<real>::max());}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{return}\ bsdfSample.\mbox{\hyperlink{classph_1_1_bsdf_sample_query_ae5f5dce90d4b33005528d3725d8f2ede}{outputs}}.\mbox{\hyperlink{classph_1_1_bsdf_sample_output_ab8a034ca50318eaf24b20ef8523a572e}{isMeasurable}}()\ \&\&}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(X,\ bsdfSample.\mbox{\hyperlink{classph_1_1_bsdf_sample_query_ae5f5dce90d4b33005528d3725d8f2ede}{outputs}}.\mbox{\hyperlink{classph_1_1_bsdf_sample_output_a3b6bf50417a3d5c14ffa49ed470509a9}{L}});}
\DoxyCodeLine{00114\ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a0a3a624ab60abac6864c77cc8a8482a9}{SurfaceTracer::doBsdfEvaluation}}(\mbox{\hyperlink{classph_1_1_bsdf_eval_query}{BsdfEvalQuery}}\&\ bsdfEval)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00117\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00118\ \ \ \ \ PH\_ASSERT(m\_scene);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}\&\ \ \ \ \ \ \ \ \ X\ \ \ \ \ \ \ \ \ =\ bsdfEval.\mbox{\hyperlink{classph_1_1_bsdf_eval_query_a131b546e65d9b273d7c95acef12b6b62}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_eval_input_a173fb12164d4aeff724224f607662239}{X}};}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_sidedness_agreement}{SidednessAgreement}}\&\ sidedness\ =\ bsdfEval.\mbox{\hyperlink{classph_1_1_bsdf_eval_query_adafcfa94acb2be574bf299689057d50e}{context}}.\mbox{\hyperlink{classph_1_1_bsdf_query_context_a4019270743658c949cc413403182f1e9}{sidedness}};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordflow}{if}(!X.\mbox{\hyperlink{classph_1_1_surface_hit_a5aa56bbfe581343becbdd2f3f7c89d66}{hasSurfaceOptics}}()\ ||}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ !sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(X,\ bsdfEval.\mbox{\hyperlink{classph_1_1_bsdf_eval_query_a131b546e65d9b273d7c95acef12b6b62}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_eval_input_af240ea236a9b22a409559aa650505c88}{V}})\ ||}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ !sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(X,\ bsdfEval.\mbox{\hyperlink{classph_1_1_bsdf_eval_query_a131b546e65d9b273d7c95acef12b6b62}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_eval_input_ab7cd2c15b5a8d5282537a3f2c5cfad8c}{L}}))}
\DoxyCodeLine{00126\ \ \ \ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ getSurfaceOptics(X)-\/>\mbox{\hyperlink{classph_1_1_surface_optics_a058042308616bcf1c7a63ab27b211cc4}{calcBsdf}}(bsdfEval);}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{return}\ bsdfEval.\mbox{\hyperlink{classph_1_1_bsdf_eval_query_a8b919e7e55a87dee8c6a382e5f8817d6}{outputs}}.\mbox{\hyperlink{classph_1_1_bsdf_eval_output_ad8e6365b61b13132f94ebc8d6b2f7a6b}{isGood}}();}
\DoxyCodeLine{00133\ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classph_1_1_surface_tracer_a1c9ab40820e749ead9ddd211bedf5c19}{SurfaceTracer::doBsdfPdfQuery}}(\mbox{\hyperlink{classph_1_1_bsdf_pdf_query}{BsdfPdfQuery}}\&\ bsdfPdfQuery)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00136\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00137\ \ \ \ \ PH\_ASSERT(m\_scene);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_surface_hit}{SurfaceHit}}\&\ \ \ \ \ \ \ \ \ X\ \ \ \ \ \ \ \ \ =\ bsdfPdfQuery.\mbox{\hyperlink{classph_1_1_bsdf_pdf_query_a774cb03ebfd0cbfc0b15bdee170f5172}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_pdf_input_a08bcdd92c242a1d11b45115d51510123}{X}};}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classph_1_1_sidedness_agreement}{SidednessAgreement}}\&\ sidedness\ =\ bsdfPdfQuery.\mbox{\hyperlink{classph_1_1_bsdf_pdf_query_aed028a52e64fd9f5872b0659bda71a11}{context}}.\mbox{\hyperlink{classph_1_1_bsdf_query_context_a4019270743658c949cc413403182f1e9}{sidedness}};}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{if}(!X.\mbox{\hyperlink{classph_1_1_surface_hit_a5aa56bbfe581343becbdd2f3f7c89d66}{hasSurfaceOptics}}()\ ||}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ !sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(X,\ bsdfPdfQuery.\mbox{\hyperlink{classph_1_1_bsdf_pdf_query_a774cb03ebfd0cbfc0b15bdee170f5172}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_pdf_input_a70de4792d970072514d82d9fc284ea3f}{V}})\ ||}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ !sidedness.\mbox{\hyperlink{classph_1_1_sidedness_agreement_a9bb073e57776d8f441f74075ba1fbe66}{isSidednessAgreed}}(X,\ bsdfPdfQuery.\mbox{\hyperlink{classph_1_1_bsdf_pdf_query_a774cb03ebfd0cbfc0b15bdee170f5172}{inputs}}.\mbox{\hyperlink{classph_1_1_bsdf_pdf_input_a6c4369dc4b7268e20bf3195c24c05f7e}{L}}))}
\DoxyCodeLine{00145\ \ \ \ \ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00147\ \ \ \ \ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ getSurfaceOptics(X)-\/>\mbox{\hyperlink{classph_1_1_surface_optics_a603130ce2c84dc114a1f0693302c6394}{calcBsdfSamplePdfW}}(bsdfPdfQuery);}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{return}\ bsdfPdfQuery.\mbox{\hyperlink{classph_1_1_bsdf_pdf_query_a748287405dc1f954105665d4fd107d11}{outputs}}.\mbox{\hyperlink{classph_1_1_bsdf_pdf_output_a756d1e7f71177f4061dabde77b1fcda5}{sampleDirPdfW}}\ >\ 0.0\_r;}
\DoxyCodeLine{00152\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \}\textcolor{comment}{//\ end\ namespace\ ph}}

\end{DoxyCode}
